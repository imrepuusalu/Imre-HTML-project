<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Questionnaire Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        .container {
            width: 100%;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }

        .header {
            margin-bottom: 30px;
        }

        .question-container {
            margin-bottom: 20px;
        }

        .question-container input,
        .question-container textarea {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .options-container {
            margin-top: 10px;
        }

        .option-input {
            margin: 5px 0;
        }

        .button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            margin-top: 10px;
        }

        .button:hover {
            background-color: #45a049;
        }

        .question-preview {
            margin-top: 20px;
        }

        .clear-button {
            background-color: #f44336; /* Red */
            margin-top: 10px;
        }

        .clear-button:hover {
            background-color: #e53935;
        }

        .next-button {
            background-color: #008CBA;
            margin-top: 20px;
        }

        .next-button:hover {
            background-color: #007B9A;
        }

        /* Styling for the circle and text */
        .circle {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            border: 1px solid #000;
            display: inline-block;
            margin-right: 10px;
        }

        .line {
            border-top: 1px solid #000;
            margin: 10px 0;
            width: 100%;
            height: 20px; /* Gives enough space for writing */
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2>Create Your Test</h2>
    </div>

    <div class="question-container">
        <label for="question">Enter your question:</label>
        <input type="text" id="question" placeholder="Type your question here">

        <label for="type">Select question type:</label>
        <select id="type">
            <option value="multiple-choice">Multiple Choice</option>
            <option value="translation">Translation</option>
            <option value="open-ended">Open-ended</option>
        </select>

        <div id="options-container" class="options-container">
            <!-- This will dynamically show input fields for multiple-choice options -->
        </div>

        <button class="button" onclick="addQuestion()">Add Question</button>
        <button class="button clear-button" onclick="clearQuestions()">Clear Questions</button>
    </div>

    <div id="questionPreview" class="question-preview">
        <!-- Display the preview of added questions -->
    </div>

    <button class="button next-button" onclick="goToPrintable()">Go to Printable</button>
</div>

<script>
    // Function to dynamically add options input for multiple choice
    function updateOptions() {
        const questionType = document.getElementById('type').value;
        const optionsContainer = document.getElementById('options-container');

        optionsContainer.innerHTML = ''; // Clear options container

        if (questionType === 'multiple-choice') {
            // Create input fields for multiple-choice options
            for (let i = 1; i <= 4; i++) {
                const input = document.createElement('input');
                input.className = 'option-input';
                input.type = 'text';
                input.placeholder = `Option ${i}`;
                input.id = `option${i}`;
                optionsContainer.appendChild(input);
            }
        } else if (questionType === 'translation' || questionType === 'open-ended') {
            // Create a line for translation or open-ended questions
            const line = document.createElement('div');
            line.className = 'line';
            optionsContainer.appendChild(line);
        }
    }

    // Call the function to update options based on the selected question type
    document.getElementById('type').addEventListener('change', updateOptions);
    updateOptions();  // Call on page load to initialize options based on the default type

    // Function to add a question to the localStorage
    function addQuestion() {
        const questionText = document.getElementById('question').value;
        const questionType = document.getElementById('type').value;

        if (!questionText) {
            alert("Please enter a question.");
            return;
        }

        let options = [];
        if (questionType === 'multiple-choice') {
            for (let i = 1; i <= 4; i++) {
                const option = document.getElementById(`option${i}`).value;
                if (option) options.push(option);
            }
        }

        const newQuestion = {
            question: questionText,
            type: questionType,
            options: options
        };

        // Get existing questions from localStorage or create a new array if none exist
        let questions = JSON.parse(localStorage.getItem('testQuestions')) || [];
        
        // Check to make sure the limit (e.g., 5 questions) is not exceeded
        if (questions.length >= 5) {
            alert("You can only add up to 5 questions.");
            return;
        }

        questions.push(newQuestion);

        // Save the updated questions array to localStorage
        localStorage.setItem('testQuestions', JSON.stringify(questions));

        // Show preview of added questions
        previewQuestions();
    }

    // Function to preview all added questions
    function previewQuestions() {
        const questions = JSON.parse(localStorage.getItem('testQuestions')) || [];
        const previewContainer = document.getElementById('questionPreview');
        previewContainer.innerHTML = ''; // Clear the preview container

        questions.forEach((question, index) => {
            const questionElement = document.createElement('div');
            questionElement.innerHTML = `<strong>Q${index + 1}: </strong>${question.question}`;

            if (question.type === 'multiple-choice') {
                question.options.forEach(option => {
                    questionElement.innerHTML += `<br><span class="circle"></span> ${option}`;
                });
            } else if (question.type === 'translation' || question.type === 'open-ended') {
                questionElement.innerHTML += `<br><div class="line"></div>`;  // For translation and open-ended questions, add a line
            }

            previewContainer.appendChild(questionElement);
        });
    }

    // Function to clear all questions from localStorage
    function clearQuestions() {
        if (confirm("Are you sure you want to clear all questions?")) {
            localStorage.removeItem('testQuestions');
            previewQuestions(); // Update preview after clearing
        }
    }

    // Function to go to printable page
    function goToPrintable() {
        // Navigate to the printable page (third page)
        window.location.href = 'printable.html'; // Change this if needed
    }

    // Call to display the preview questions initially
    previewQuestions();
</script>

</body>
</html>
